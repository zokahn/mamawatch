<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mom's Safety Monitor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Mom's Safety Monitor</h1>
        <div id="status" class="status">
            <p>Button Status: <span id="button-status">Waiting...</span></p>
            <p>Last Action: <span id="last-action">None</span></p>
        </div>
        <div id="message" class="message hidden">
            <p id="message-text"></p>
        </div>
        <div id="log-container">
            <h2>Event Log</h2>
            <ul id="event-log">
                {% for message in messages %}
                <li>
                    <strong>Status:</strong> {{ message[2] }}<br>
                    <strong>Action:</strong> {{ message[3] }}<br>
                    <strong>Time:</strong> {{ message[1] }}<br>
                    <strong>Acknowledged:</strong> {{ 'Yes' if message[4] else 'No' }}<br>
                    {% if message[5] %}
                    <strong>Note:</strong> {{ message[5] }}<br>
                    {% endif %}
                    {% if not message[4] %}
                    <button class="ack-button" data-message-id="{{ message[0] }}">Acknowledge</button>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        <div id="acknowledge-form" class="hidden">
            <h2>Acknowledge Event</h2>
            <form id="ack-form">
                <input type="hidden" id="ack-message-id">
                <label for="ack-note">Note:</label>
                <textarea id="ack-note" rows="3"></textarea>
                <button type="submit">Acknowledge</button>
            </form>
        </div>
    </div>
    <a href="{{ url_for('main.diagnostics') }}" class="button">View Diagnostics</a>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
